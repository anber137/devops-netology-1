devops-netology
===============

# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."

## Задача 1: Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

Основная разница в необходимости модифицировать гостевые ОС:
* При аппаратной виртуализации она не требуется;
* Для паравиртуализации нужна модификация ядра и драйверов;
* При виртуализации средствами ОС, гостевая ОС не имеет собственного ядра, использует ядро хоста.

Ещё разница в производительности. Чем больше модифицирована ОС, тем производительность выше. Наиболее высокая у виртуализации средствами ОС, так как приложения напрямую используют ядро хостовой ОС.

## Задача 2: Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

| Условия | Организация | Почему |
| --- | --- | --- |
| Высоконагруженная база данных, чувствительная к отказу | физические сервера | Виртуализация даёт оверхед и увеличивает латентность. В высоконагруженной системе это нежелательно, а достичь отказоустойчивости можно резервированием. Постоянно нагруженной системе потребуется максимум ресурсов хоста, присутствие соседей которые могут их отобрать тоже нежелательно.  |
| Различные web-приложения | виртуализация уровня ОС | Современная практика - разворачивать часто и много веб-приложений на одном хосте, при этом нужно обеспечить их изоляцию друг от друга. Виртуализация ОС подходит лучше всего, так свернуть приложение в контейнер и развернуть из него быстрей, чем делать это с виртуальными машинами с полноценной ОС и отдельным ядром. |
| Windows системы для использования бухгалтерским отделом | паравиртуализация | Виртуализация поможет системе быть более отказоустойчивой, из предложенных вариантов для Windows возможна только паравиртуализация. |
| Системы, выполняющие высокопроизводительные расчеты на GPU | виртуализация уровня ОС | виртуализация GPU может потребоваться в проектах с машинным обучением, из предложенных видов виртуализации для GPU возможна только виртуализация средствами ОС |

## Задача 3: Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

> 1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.

Подойдут Hyper-V, vSphere: они оба хорошо поддерживают виртуальные машины с Windows и Linux, имеют встроенные перечисленные возможности (балансировка, репликация, бекапы) и могут работать в кластере гипервизоров, что необходимо для работы 100 виртуальных машин. 

> 2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.

Лучше всего подойдёт Proxmox в режиме KVM: open source решение, хорошо поддерживает Windows гостей, имеет возможности по управлению сравнимые с платными гипервизорами.

> 3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.

Hyper-V Server, максимально совместим т.к. от Microsoft, полностью бесплатен.

> 4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

Оптимальней всего будет LXD, т.к. содержит огромную библиотеку с разными дистрибутивами в большом количестве конфигураций в виде контейнеров. Версия 4 позволяет запускать ещё и виртуальные машины, что позволит тестить даже ПО, требующее собственное полноценное ядро. 

## Задача 4: Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

Если я правильно понимаю, имеется в виду ситуация, когда используется несколько гипервизоров одного типа (например, VMWare ESXi и KVM), или примерно одного (например, Xen паравиртуализация и hardware assisted виртуализация с KVM или VMWare).
Основная проблема, из которой вытекает всё остальное - нужно в Н раз больше усилий на изучение и поддержку одного и того же.  
- Б**о**льшие расходы на штат инженеров, чтобы закрыть потребность в экспертизе по используемым технологиям
- Больше заморочек с мониторингом 
- Если требуется интегрировать гипервизор с какими-то внешними системами - нужно делать отдельно для каждой платформы
- В нужный момент может не оказаться специалистов по технологии, с которой возникли проблемы
- Скорей всего будет сложно выбирать железо: одни вендоры поддерживают одно, другие другое, нужно больше тратиться на резерв, сложно взаимно заменять аппаратные компоненты
- 

Решения мне видятся предельно простые: нанять больше людей, купить больше поддержки у вендоров, и/или использовать какую-то абстрагирующую прослойку вроде OpenStack, чтобы решить хотя бы задачи по интеграции и унификации управления. Использовать тот гипервизор, где у нас меньше экспертизы или специалистов, для менее критичных ресурсов. 

Лучшее решение, конечно, мигрировать на одну платформу, но полагаю это может быть не всегда возможно: всегда есть какое-то легаси, которое лучше не трогать без надобности, или раньше было дорогое и платное решение, теперь бюджет только на опенсорс, или какие-то административные ограничения и т.д. Либо мы работаем в датацентре и тогда, скорей всего, поддержку множества гипервизоров от нас будут ожидать клиенты.

Если бы я выбирал, то делал бы максимально единообразную систему с минимумом разнообразия используемых технологий в основе.

Конечно, если речь идёт о среде, где используются как виртуальные машины, так и контейнеры, то это "стандарт отрасли". Он несёт все минусы, которые я перечислил выше, но это параллельно развивающиеся технологии, имеющие свою нишу, и часто требуется знать и применять как минимум один гипервизор 1/2 уровня и какую-то технологию виртуализации.
